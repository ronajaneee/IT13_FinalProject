<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="IT13_FinalProject.CustomerManagementView"
             xmlns:local="clr-namespace:IT13_FinalProject">
    <ScrollView>
        <VerticalStackLayout Padding="24" Spacing="24">
            <Label Text="Customer Management"
                   FontSize="28"
                   FontAttributes="Bold"
                   TextColor="#1e2445"
                   HorizontalOptions="Center" />

            <!-- Search Section -->
            <Frame BackgroundColor="#4B91FF"
                   CornerRadius="16"
                   Padding="18"
                   Margin="0,0,0,12">
                <Grid RowSpacing="12" ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Entry Placeholder="Search customers..."
                           PlaceholderColor="LightGray"
                           TextColor="White"
                           TextChanged="OnSearchTextChanged"
                           Grid.Column="0" />

                    <Button Text="Add New"
                            Grid.Column="1"
                            BackgroundColor="#FFB84B"
                            TextColor="White"
                            CornerRadius="8"
                            Command="{Binding AddCustomerCommand}" />
                </Grid>
            </Frame>

            <!-- Customers List -->
            <CollectionView ItemsSource="{Binding Customers}">
                <CollectionView.ItemsLayout>
                    <!-- Moderate spacing between customer cards -->
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="24" />
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="local:Customer">
                        <Frame Margin="0,0,0,24"
                               BackgroundColor="#2D3748"
                               CornerRadius="16"
                               Padding="20"
                               HasShadow="False">
                            <Grid RowSpacing="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <!-- Name -->
                                <VerticalStackLayout Grid.Row="0" Spacing="4">
                                    <Label Text="{Binding FirstName}" 
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="White" />
                                    <Label Text="{Binding LastName}"
                                           FontSize="16"
                                           TextColor="White" />
                                </VerticalStackLayout>

                                <!-- Contact Info -->
                                <VerticalStackLayout Grid.Row="1" Spacing="6" Margin="0,6,0,0">
                                    <Label Text="{Binding Email, StringFormat='Email: {0}'}"
                                           FontSize="14" 
                                           TextColor="#FFB84B" />
                                    <Label Text="{Binding Phone, StringFormat='Phone: {0}'}"
                                           FontSize="14" 
                                           TextColor="WhiteSmoke" />
                                    <Label Text="{Binding Address, StringFormat='Address: {0}'}"
                                           FontSize="14"
                                           TextColor="#4B91FF" />
                                </VerticalStackLayout>

                                <!-- Action Buttons -->
                                <HorizontalStackLayout Grid.Row="2"
                                                       Spacing="12"
                                                       Margin="0,12,0,0"
                                                       HorizontalOptions="Start">
                                    <Button Text="View"
                                            BackgroundColor="#2D3748"
                                            TextColor="White"
                                            CornerRadius="8"
                                            HeightRequest="44"
                                            FontSize="16"
                                            Padding="16,0"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type local:CustomerManagementView}}, Path=BindingContext.ViewCustomerCommand}"
                                            CommandParameter="{Binding .}" />
                                    <Button Text="Edit"
                                            BackgroundColor="#4B91FF"
                                            TextColor="White"
                                            CornerRadius="8"
                                            HeightRequest="44"
                                            FontSize="16"
                                            Padding="16,0"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type local:CustomerManagementView}}, Path=BindingContext.EditCustomerCommand}"
                                            CommandParameter="{Binding .}" />
                                    <Button Text="Delete"
                                            BackgroundColor="#FF4B91"
                                            TextColor="White"
                                            CornerRadius="8"
                                            HeightRequest="44"
                                            FontSize="16"
                                            Padding="16,0"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type local:CustomerManagementView}}, Path=BindingContext.DeleteCustomerCommand}"
                                            CommandParameter="{Binding .}" />
                                </HorizontalStackLayout>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentView>